<!DOCTYPE html>
<html lang='en'>
<head>
	<meta charset='utf-8'>
	<title>Evaline: Status</title>
	<link rel='stylesheet' href='style/index.css'>
  <meta http-equiv='X-UA-Compatible' content='IE=edge'>
  <meta name='viewport' content='width=device-width, initial-scale=1'>
	<!--[if IE]>
		<script src='http://html5shiv.googlecode.com/svn/trunk/html5.js'></script>
	<![endif]-->
  <meta name='description' content='Evaline: Status'>

  <link rel='apple-touch-icon' sizes='57x57' href='favicon/apple-icon-57x57.png'>
  <link rel='apple-touch-icon' sizes='60x60' href='favicon/apple-icon-60x60.png'>
  <link rel='apple-touch-icon' sizes='72x72' href='favicon/apple-icon-72x72.png'>
  <link rel='apple-touch-icon' sizes='76x76' href='favicon/apple-icon-76x76.png'>
  <link rel='apple-touch-icon' sizes='114x114' href='favicon/apple-icon-114x114.png'>
  <link rel='apple-touch-icon' sizes='120x120' href='favicon/apple-icon-120x120.png'>
  <link rel='apple-touch-icon' sizes='144x144' href='favicon/apple-icon-144x144.png'>
  <link rel='apple-touch-icon' sizes='152x152' href='favicon/apple-icon-152x152.png'>
  <link rel='apple-touch-icon' sizes='180x180' href='favicon/apple-icon-180x180.png'>
  <link rel='icon' type='image/png' sizes='192x192'  href='favicon/android-icon-192x192.png'>
  <link rel='icon' type='image/png' sizes='32x32' href='favicon/favicon-32x32.png'>
  <link rel='icon' type='image/png' sizes='96x96' href='favicon/favicon-96x96.png'>
  <link rel='icon' type='image/png' sizes='16x16' href='favicon/favicon-16x16.png'>
  <link rel='manifest' href='favicon/manifest.json'>
  <meta name='msapplication-TileColor' content='#fefefe '>
  <meta name='msapplication-TileImage' content='favicon/ms-icon-144x144.png'>
  <meta name='theme-color' content='#fefefe '>
</head>

<body>
  <header>
    <h1 class='evaline happy' id='mainStatus'>All systems operational.</h1>
    <p id='mainStatusMessage'>
      Write the status message here about what's going on.
    </p>
    <div class='button-row'>
      <a class='button' title='Report an issue' href='#'>
        Report an issue
      </a>

      <a class='button' title='Get updates' href='#'>
        Get updates
      </a>
  </header>
  <section id='services'>
    <div id='scheduler'>
      <div>Session Scheduling</div>
      <div id='scheduler-description'>All systems nominal</div>
    </div>
    <div id='driver'>
      <div>Driver Application</div>
      <div id='driver-description'>All systems nominal</div>
    </div>
    <div id='admin'>
      <div>Admin Application</div>
      <div id='admin-description'>All systems nominal</div>
    </div>
    <div id='calendar'>
      <div>Calendar integration</div>
      <div id='calendar-description'>All systems nominal</div>
    </div>
    <div id='sms' class='error'>
      <div>SMS notifications</div>
      <div id='sms-description'>SMS notifications provider offline, we're working on a fix.</div>
    </div>
    <div id='email' class='warning'>
      <div>Email notifications</div>
      <div id='email-description'>Some reports of email delivery failures, engineering team is investigating.</div>
    </div>
  </section>
</body>

<script>
  window.onload = function () {
    // Write a general status message here.
    const generalMessage = `We're experiencing some notification issues, but are working with our API partners to resolve them. We expect to be fully operational within the hour.`

    let desc = document.querySelector('[name=description]')
    let status = 0 // status 0 = green, 1 = yellow, 2 = red
    let services = document.getElementById('services').childNodes
    for (let service of services) {
      if (service.className === 'warning') {
        if (status === 0) status = 1
      } else if (service.className === 'error') status = 2
    }

    switch (status) {
      case 2: {
        const title = 'experiencing issues'
        document.title = `Evaline status: ${title}`
        desc.content = `Evaline status: ${title}`
        document.getElementById('mainStatus').innerHTML = title
        document.getElementById('mainStatus').className = 'evaline upset'
        document.getElementById('mainStatusMessage').innerHTML = generalMessage
      } break
      case 1: {
        const title = 'some problems detected'
        document.title = `Evaline status: ${title}`
        desc.content = `Evaline status: ${title}`
        document.getElementById('mainStatus').innerHTML = title
        document.getElementById('mainStatus').className = 'evaline upset'
        document.getElementById('mainStatusMessage').innerHTML = generalMessage
      } break
      default: {
        const title = 'all systems operational'
        document.title = `Evaline status: ${title}`
        desc.content = `Evaline status: ${title}`
        document.getElementById('mainStatus').innerHTML = title
        document.getElementById('mainStatusMessage') = ''
      }
    }
  }
</script>
</html>
